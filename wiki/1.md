# PointerSearch-X 的教程

指针链扫描有什么用呢？

想象一下，一个游戏的难度太高了，你想要作弊，每次开始游戏前你都需要花费几分钟时间来执行内存扫描找到数据的地址；

如果你需要的数据很隐蔽，例如游戏中的角色坐标，你可能需要更长时间才能找到，在这之前你需要请求敌人“先不要攻击我”。

而使用指针链你可以在 0.1秒 内找到数据的地址，你甚至可以分享给其它人使用（只要游戏版本相同）。

在这之前，需要先知道目标程序是以64位模式还是32位模式运行，PointerSearch-X 暂时只支持扫描64位原生应用程序。

首先需要知道目标地址和进程pid，我推荐使用 [PINCE](https://github.com/korcankaraokcu/PINCE)。

![img1](img/1.png)

然后运行 `sudo ./dumper disk --pid 4114` 命令转储进程内存。

![img2](img/2.png)

默认情况下它会创建两个文件 `*.bin` 和 `*.info.txt`。

接下来用文本编辑器打开 `*.info.txt`, 这里面记录了一些可以作为基址的模块，它将引导后续的指针链扫描行为。

![img3](img/3.png)

我们可以去除不需要的模块，例如 `libc.so.6` `libX11-xcb.so` 之类的，它是系统库，游戏数据绝不可能在里面，所以我们删除这些行。排除无用的模块可以加快扫描速度。

最终我只保留了这些

![img4](img/4.png)

接下来运行扫描程序 

`./scanner scan --bin 4114.bin --info 4114.info.txt -t 0x84cbcfd0 -d 4 -o 0:4000`

`--bin` 指定转储的 `*.bin` 文件。

`--info` 指定我们修改过的 `*.info.txt` 文件。

`-t/--target` 指定目标地址。

`-d/--depth` 表示指针链的最大深度，目前最大仅允许 `14`。

`-o/--offset` 表示偏移范围 它最大可以支持 `-2^64:+2^64`。

注意 `-d/--depth` 和 `-o/--offset` 会极大影响扫描速度以及产生的结果。

扫描成本为 O（NN*D）（D：最大深度，N：偏移数）。一般情况下设置的数字越大，扫描越慢，结果越多。

扫描完成后它会产生一个 `*.scandata` 文件。

![img5](img/5.png)

这里面会有很多指针链，但它们并不能保证全都是有效的。

![img6](img/6.png)

我们可以重新启动目标进程，然后重新 进行 找到目标地址->转储->扫描 这个步骤。

现在我们有这些文件。

![img7](img/7.png)

执行 `scanner diff --f1 1892945584.scandata --f2 2227949520.scandata --out coin.txt`

它会把两次扫描中稳定存在的指针链储存到 `coin.txt` 文件中。

![img8](img/8.png)

我们随便找一个验证能不能用。

执行命令 `sudo ./dumper test --pid 9325 --chain "libhl.so[3]+14208@1176@2280@48@648"`

成功获得了硬币的地址 `0x70d7e298`

后续我又重启了目标进程两次，可以看到，可以准确获取到动态变化的硬币地址。

![img9](img/9.png)

然后我们可以复制这个地址到 [PINCE](https://github.com/korcankaraokcu/PINCE) 中修改它。

![img10](img/10.png)

![img11](img/11.png)